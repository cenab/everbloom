---
/**
 * Photo upload page
 * Route: /w/{slug}/photos
 */
import { fetchSiteConfig } from '../../../lib/api';
import WeddingLayout from '../../../components/WeddingLayout.astro';

const { slug } = Astro.params;

if (!slug) {
  return Astro.redirect('/');
}

const config = await fetchSiteConfig(slug);

if (!config) {
  return new Response('Wedding not found', { status: 404 });
}

const photoEnabled = config.features.PHOTO_UPLOAD;
const weddingTitle = `${config.wedding.partnerNames[0]} & ${config.wedding.partnerNames[1]}`;
---

<WeddingLayout config={config}>
  <section
    class="photo-page"
    style={`--primary: ${config.theme.primary}; --accent: ${config.theme.accent}; --neutral-light: ${config.theme.neutralLight}; --neutral-dark: ${config.theme.neutralDark};`}
  >
    <div class="photo-page-content">
      <a href={`/w/${config.wedding.slug}`} class="back-link">Back to the wedding site</a>
      <h1 class="photo-title">Share your photos</h1>
      <p class="photo-description">
        We would love to see the moments you captured during ${weddingTitle}. Add your favorites to our shared album.
      </p>

      {photoEnabled ? (
        <div class="upload-card" id="upload">
          <label class="upload-button" for="photo-files">
            Add photos
          </label>
          <input id="photo-files" class="upload-input" type="file" multiple accept="image/*" />
          <p class="upload-hint">You can select multiple images at once.</p>
        </div>
      ) : (
        <div class="photo-disabled">
          Photo sharing is currently closed for this event.
        </div>
      )}
    </div>
  </section>
</WeddingLayout>

<style>
  .photo-page {
    background-color: var(--neutral-light);
    padding: 6rem 2rem 5rem;
  }

  .photo-page-content {
    max-width: 720px;
    margin: 0 auto;
    text-align: center;
  }

  .back-link {
    display: inline-block;
    font-family: 'Inter', 'Helvetica Neue', sans-serif;
    font-size: 0.95rem;
    color: var(--primary);
    text-decoration: none;
    margin-bottom: 2.5rem;
  }

  .back-link:hover {
    opacity: 0.8;
  }

  .photo-title {
    font-family: 'Cormorant Garamond', 'Georgia', serif;
    font-size: clamp(2rem, 6vw, 3.25rem);
    font-weight: 400;
    color: var(--neutral-dark);
    margin: 0 0 1.5rem 0;
    letter-spacing: 0.02em;
  }

  .photo-description {
    font-family: 'Inter', 'Helvetica Neue', sans-serif;
    font-size: 1.1rem;
    line-height: 1.7;
    color: var(--neutral-dark);
    opacity: 0.78;
    margin: 0 0 3rem 0;
  }

  .upload-card {
    padding: 2.5rem;
    border-radius: 16px;
    background-color: var(--neutral-light);
    box-shadow: 0 20px 50px rgba(45, 45, 45, 0.08);
  }

  .upload-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-family: 'Inter', 'Helvetica Neue', sans-serif;
    font-size: 1rem;
    font-weight: 500;
    color: var(--neutral-light);
    background-color: var(--primary);
    padding: 1rem 2.75rem;
    border-radius: 999px;
    cursor: pointer;
  }

  .upload-button:hover {
    opacity: 0.9;
  }

  .upload-input {
    position: absolute;
    opacity: 0;
    pointer-events: none;
  }

  .upload-hint {
    font-family: 'Inter', 'Helvetica Neue', sans-serif;
    font-size: 0.95rem;
    color: var(--neutral-dark);
    opacity: 0.6;
    margin: 1.5rem 0 0 0;
  }

  .photo-disabled {
    font-family: 'Inter', 'Helvetica Neue', sans-serif;
    font-size: 1rem;
    color: var(--neutral-dark);
    opacity: 0.75;
    padding: 2rem;
    border-radius: 16px;
    background-color: var(--neutral-light);
    box-shadow: 0 20px 50px rgba(45, 45, 45, 0.08);
  }

  @media (max-width: 640px) {
    .upload-card {
      padding: 2rem 1.5rem;
    }
  }
</style>
