import { c as createComponent, a as createAstro, r as renderTemplate, f as renderComponent, g as defineScriptVars, m as maybeRenderHead, b as addAttribute } from '../../../chunks/astro/server_6gLzEsed.mjs';
import { a as fetchSiteConfig } from '../../../chunks/api_DY9V-Yw_.mjs';
import { $ as $$ErrorPage, a as $$PasscodeGateWrapper, b as $$WeddingLayout } from '../../../chunks/ErrorPage_Cw19BkIb.mjs';
/* empty css                                       */
export { renderers } from '../../../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro();
const $$Music = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$Music;
  const { slug } = Astro2.params;
  if (!slug) {
    return Astro2.redirect("/");
  }
  let config = null;
  let fetchError = false;
  try {
    config = await fetchSiteConfig(slug);
  } catch {
    fetchError = true;
  }
  const showError = !config || fetchError;
  const errorType = fetchError ? "unavailable" : "not-found";
  const musicEnabled = config?.features?.MUSIC_REQUESTS ?? false;
  config ? `${config.wedding.partnerNames[0]} & ${config.wedding.partnerNames[1]}` : "";
  const weddingSlug = config?.wedding.slug ?? "";
  const theme = config?.theme ?? { primary: "#c9826b", accent: "#8fac8b", neutralLight: "#faf8f5", neutralDark: "#2d2d2d" };
  const apiBaseUrl = "http://localhost:3001/api";
  return renderTemplate`${showError && renderTemplate`${renderComponent($$result, "ErrorPage", $$ErrorPage, { "type": errorType, "data-astro-cid-fpueaa4s": true })}`}${!showError && config && renderTemplate`${renderComponent($$result, "PasscodeGateWrapper", $$PasscodeGateWrapper, { "config": config, "data-astro-cid-fpueaa4s": true }, { "default": async ($$result2) => renderTemplate`${renderComponent($$result2, "WeddingLayout", $$WeddingLayout, { "config": config, "data-astro-cid-fpueaa4s": true }, { "default": async ($$result3) => renderTemplate`${maybeRenderHead()}<section class="music-page"${addAttribute(`--primary: ${theme.primary}; --accent: ${theme.accent}; --neutral-light: ${theme.neutralLight}; --neutral-dark: ${theme.neutralDark};`, "style")} data-astro-cid-fpueaa4s><div class="music-page-content" data-astro-cid-fpueaa4s><a${addAttribute(`/w/${weddingSlug}`, "href")} class="back-link" data-astro-cid-fpueaa4s>Back to the wedding site</a><h1 class="music-title" data-astro-cid-fpueaa4s>Suggest a Song</h1><p class="music-description" data-astro-cid-fpueaa4s>
Help us create the perfect playlist for our celebration! Share your favorite songs and we'll consider them for our big day.
</p>${musicEnabled ? renderTemplate`<div class="music-card" id="music-form-container" data-astro-cid-fpueaa4s><form id="music-form" class="music-form" data-astro-cid-fpueaa4s><div class="form-group" data-astro-cid-fpueaa4s><label for="songTitle" data-astro-cid-fpueaa4s>Song Title</label><input type="text" id="songTitle" name="songTitle" required placeholder="Enter the song name" maxlength="200" data-astro-cid-fpueaa4s></div><div class="form-group" data-astro-cid-fpueaa4s><label for="artistName" data-astro-cid-fpueaa4s>Artist</label><input type="text" id="artistName" name="artistName" required placeholder="Enter the artist name" maxlength="200" data-astro-cid-fpueaa4s></div><div class="form-group" data-astro-cid-fpueaa4s><label for="requesterName" data-astro-cid-fpueaa4s>Your Name <span class="optional" data-astro-cid-fpueaa4s>(optional)</span></label><input type="text" id="requesterName" name="requesterName" placeholder="Let us know who suggested this" maxlength="100" data-astro-cid-fpueaa4s></div><button type="submit" class="submit-button" id="submit-button" data-astro-cid-fpueaa4s><span id="button-text" data-astro-cid-fpueaa4s>Submit Song Request</span><span id="button-loading" class="hidden" data-astro-cid-fpueaa4s>Submitting...</span></button><div id="error-message" class="error-message hidden" data-astro-cid-fpueaa4s></div></form><div id="success-message" class="success-message hidden" data-astro-cid-fpueaa4s><div class="success-icon" data-astro-cid-fpueaa4s>â™ª</div><h2 data-astro-cid-fpueaa4s>Thank you!</h2><p data-astro-cid-fpueaa4s>Your song request has been submitted. We appreciate your suggestion!</p><button type="button" class="suggest-another-button" id="suggest-another" data-astro-cid-fpueaa4s>
Suggest Another Song
</button></div></div>` : renderTemplate`<div class="music-disabled" data-astro-cid-fpueaa4s>
Song requests are currently not available for this wedding.
</div>`}</div></section>` })}` })}`}${!showError && musicEnabled && renderTemplate(_a || (_a = __template(["<script>(function(){", "\n    document.addEventListener('DOMContentLoaded', () => {\n      const form = document.getElementById('music-form');\n      const submitButton = document.getElementById('submit-button');\n      const buttonText = document.getElementById('button-text');\n      const buttonLoading = document.getElementById('button-loading');\n      const errorMessage = document.getElementById('error-message');\n      const successMessage = document.getElementById('success-message');\n      const suggestAnother = document.getElementById('suggest-another');\n\n      if (form) {\n        form.addEventListener('submit', async (e) => {\n          e.preventDefault();\n\n          // Hide previous error\n          if (errorMessage) {\n            errorMessage.classList.add('hidden');\n          }\n\n          // Get form data\n          const songTitle = document.getElementById('songTitle').value.trim();\n          const artistName = document.getElementById('artistName').value.trim();\n          const requesterName = document.getElementById('requesterName').value.trim();\n\n          // Validate\n          if (!songTitle || !artistName) {\n            if (errorMessage) {\n              errorMessage.textContent = 'Please fill in the song title and artist name.';\n              errorMessage.classList.remove('hidden');\n            }\n            return;\n          }\n\n          // Show loading state\n          if (submitButton) submitButton.disabled = true;\n          if (buttonText) buttonText.classList.add('hidden');\n          if (buttonLoading) buttonLoading.classList.remove('hidden');\n\n          try {\n            const response = await fetch(`${apiBaseUrl}/music/${weddingSlug}/request`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({\n                songTitle,\n                artistName,\n                requesterName: requesterName || undefined,\n              }),\n            });\n\n            const data = await response.json();\n\n            if (data.ok) {\n              // Show success message\n              if (form) form.classList.add('hidden');\n              if (successMessage) successMessage.classList.remove('hidden');\n            } else {\n              throw new Error(data.error || 'Failed to submit song request');\n            }\n          } catch (err) {\n            if (errorMessage) {\n              errorMessage.textContent = 'Something went wrong. Please try again.';\n              errorMessage.classList.remove('hidden');\n            }\n          } finally {\n            // Reset loading state\n            if (submitButton) submitButton.disabled = false;\n            if (buttonText) buttonText.classList.remove('hidden');\n            if (buttonLoading) buttonLoading.classList.add('hidden');\n          }\n        });\n      }\n\n      // Handle \"Suggest Another\" button\n      if (suggestAnother) {\n        suggestAnother.addEventListener('click', () => {\n          // Reset form\n          if (form) {\n            form.reset();\n            form.classList.remove('hidden');\n          }\n          if (successMessage) successMessage.classList.add('hidden');\n          if (errorMessage) errorMessage.classList.add('hidden');\n        });\n      }\n    });\n  })();</script>"], ["<script>(function(){", "\n    document.addEventListener('DOMContentLoaded', () => {\n      const form = document.getElementById('music-form');\n      const submitButton = document.getElementById('submit-button');\n      const buttonText = document.getElementById('button-text');\n      const buttonLoading = document.getElementById('button-loading');\n      const errorMessage = document.getElementById('error-message');\n      const successMessage = document.getElementById('success-message');\n      const suggestAnother = document.getElementById('suggest-another');\n\n      if (form) {\n        form.addEventListener('submit', async (e) => {\n          e.preventDefault();\n\n          // Hide previous error\n          if (errorMessage) {\n            errorMessage.classList.add('hidden');\n          }\n\n          // Get form data\n          const songTitle = document.getElementById('songTitle').value.trim();\n          const artistName = document.getElementById('artistName').value.trim();\n          const requesterName = document.getElementById('requesterName').value.trim();\n\n          // Validate\n          if (!songTitle || !artistName) {\n            if (errorMessage) {\n              errorMessage.textContent = 'Please fill in the song title and artist name.';\n              errorMessage.classList.remove('hidden');\n            }\n            return;\n          }\n\n          // Show loading state\n          if (submitButton) submitButton.disabled = true;\n          if (buttonText) buttonText.classList.add('hidden');\n          if (buttonLoading) buttonLoading.classList.remove('hidden');\n\n          try {\n            const response = await fetch(\\`\\${apiBaseUrl}/music/\\${weddingSlug}/request\\`, {\n              method: 'POST',\n              headers: {\n                'Content-Type': 'application/json',\n              },\n              body: JSON.stringify({\n                songTitle,\n                artistName,\n                requesterName: requesterName || undefined,\n              }),\n            });\n\n            const data = await response.json();\n\n            if (data.ok) {\n              // Show success message\n              if (form) form.classList.add('hidden');\n              if (successMessage) successMessage.classList.remove('hidden');\n            } else {\n              throw new Error(data.error || 'Failed to submit song request');\n            }\n          } catch (err) {\n            if (errorMessage) {\n              errorMessage.textContent = 'Something went wrong. Please try again.';\n              errorMessage.classList.remove('hidden');\n            }\n          } finally {\n            // Reset loading state\n            if (submitButton) submitButton.disabled = false;\n            if (buttonText) buttonText.classList.remove('hidden');\n            if (buttonLoading) buttonLoading.classList.add('hidden');\n          }\n        });\n      }\n\n      // Handle \"Suggest Another\" button\n      if (suggestAnother) {\n        suggestAnother.addEventListener('click', () => {\n          // Reset form\n          if (form) {\n            form.reset();\n            form.classList.remove('hidden');\n          }\n          if (successMessage) successMessage.classList.add('hidden');\n          if (errorMessage) errorMessage.classList.add('hidden');\n        });\n      }\n    });\n  })();</script>"])), defineScriptVars({ apiBaseUrl, weddingSlug }))}`;
}, "/Users/batu/Documents/DEVELOPMENT/wedding-bestie/apps/wedding-site/src/pages/w/[slug]/music.astro", void 0);
const $$file = "/Users/batu/Documents/DEVELOPMENT/wedding-bestie/apps/wedding-site/src/pages/w/[slug]/music.astro";
const $$url = "/w/[slug]/music";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
  __proto__: null,
  default: $$Music,
  file: $$file,
  url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
